<!DOCTYPE html>
<html lang="ja">
<head>

<!-- アクセス制限＆リンク修正用スクリプト -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    try {
      const SECRET_KEY = "93SYa4oyAeTbhKaC1Cj3hA";
      const params = new URLSearchParams(window.location.search);
      const currentKey = params.get('key');

      if (currentKey === SECRET_KEY) {
        // --- アクセス許可 ---
        // ページ内の全リンクを調べて、キーを付与する
        const links = document.querySelectorAll('a');
        links.forEach(link => {
          const href = link.getAttribute('href');
          // ローカルのHTMLファイルへのリンクかチェック (相対パスを想定)
          if (href && href.endsWith('.html') && !href.startsWith('http')) {
            link.href = href + '?key=' + currentKey;
          }
        });
      } else {
        // --- アクセス拒否 ---
        document.body.style.visibility = 'hidden';
        document.body.innerHTML = '<div style="text-align: center; padding-top: 50px; font-family: sans-serif;"><h1>アクセス権がありません</h1><p>このページは指定された場所からのみアクセスできます。</p></div>';
        document.body.style.visibility = 'visible';
        throw new Error("Invalid or missing access key.");
      }
    } catch (e) {
      // エラー発生時も念のため拒否
      document.body.style.visibility = 'hidden';
      document.body.innerHTML = '<div style="text-align: center; padding-top: 50px; font-family: sans-serif;"><h1>アクセス権がありません</h1><p>このページは指定された場所からのみアクセスできます。</p></div>';
      document.body.style.visibility = 'visible';
      throw new Error("Access denied due to an error during key check.");
    }
  });
</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>「キャンドポンプ（業務用）」異常対応チェックリスト</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">「キャンドポンプ（業務用）」異常対応チェックリスト</h1>
        <div id="checklist-container"></div>
        <div class="mt-3 text-center">
            <button id="prev-btn" class="btn btn-secondary">戻る</button>
            <button id="next-btn" class="btn btn-primary">次へ</button>
            <button id="print-btn" class="btn btn-info">結果を印刷/PDF化</button>
            <button id="exit-btn" class="btn btn-danger">終了</button>
        </div>
    </div>
    <div id="printable-area"></div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
    <script>
$(document).ready(function() {
    console.log("スクリプト開始");

    const csvData = `phase,phase_title,type,category,item,item_id,linked_item_id
1,"Phase 1: 異常検知・緊急停止",checklist,異常検知,ポンプが起動しない、またはモーターが回転しない,1_0,
1,"Phase 1: 異常検知・緊急停止",checklist,異常検知,ポンプから液体が吐出されない、または吐出量が著しく少ない,1_1,
1,"Phase 1: 異常検知・緊急停止",checklist,異常検知,運転中に「カラカラ」「ゴロゴロ」といった異音や、異常な振動がある,1_2,
1,"Phase 1: 異常検知・緊急停止",checklist,異常検知,モーターケーシングの表面温度が異常に高い,1_3,
1,"Phase 1: 異常検知・緊急停止",checklist,異常検知,モーターの過負荷保護装置（サーマルリレー）が作動している,1_4,
1,"Phase 1: 異常検知・緊急停止",checklist,異常検知,ケーシングのガスケット部から液体が漏れている,1_5,
1,"Phase 1: 異常検知・緊急停止",checklist,異常検知,（TRGモニタ付の場合）TRGの指示値が異常値（赤色域）を示している,1_6,
1,"Phase 1: 異常検知・緊急停止",checklist,異常検知,その他,1_7,
1,"Phase 1: 異常検知・緊急停止",checklist,緊急停止措置,ポンプの緊急停止ボタンを操作する。,1_8,
1,"Phase 1: 異常検知・緊急停止",checklist,緊急停止措置,制御盤の主電源を遮断し、施錠（ロックアウト）および表示（タグアウト）を実施する。,1_9,
1,"Phase 1: 異常検知・緊急停止",checklist,緊急停止措置,ポンプの吸込側および吐出側のバルブを完全に閉鎖する。,1_10,
1,"Phase 1: 異常検知・緊急停止",checklist,緊急停止措置,高温または危険な液体の場合、周辺区域への立ち入りを禁止し、安全を確保する。,1_11,
2,"Phase 2-1: 故障原因調査（使用部門）",checklist_with_status,運転状況確認,吸込側タンクの液面が不足している（空運転）,2_0,
2,"Phase 2-1: 故障原因調査（使用部門）",checklist_with_status,運転状況確認,移送液にスラリー（固形物）が混入、または粘度が高い,2_1,
2,"Phase 2-1: 故障原因調査（使用部門）",checklist_with_status,運転状況確認,吸込側・吐出側のバルブが全開になっていない,2_2,
2,"Phase 2-1: 故障原因調査（使用部門）",checklist_with_status,外観・目視点検,吸込側配管ラインのストレーナー（フィルター）に詰まりがある,2_3,
2,"Phase 2-1: 故障原因調査（使用部門）",checklist_with_status,外観・目視点検,ポンプ本体および配管のエア抜きが不十分,2_4,
2,"Phase 2-1: 故障原因調査（使用部門）",checklist_with_status,外観・目視点検,（冷却ジャケット付の場合）冷却水の流量不足、または供給停止,2_5,
2,"Phase 2-1: 故障原因調査（使用部門）",checklist_with_status,計器類確認,圧力計や流量計の指示値が異常,2_6,
2,"Phase 2-1: 故障原因調査（使用部門）",checklist_with_status,計器類確認,電流計の指示値が定格を超えている,2_7,
3,"Phase 3-1: 対策実施（使用部門）",checklist_with_status,運転状況確認,吸込側タンクに液体を補給する。,3_0,2_0
3,"Phase 3-1: 対策実施（使用部門）",checklist_with_status,運転状況確認,移送液の品質を確認し、前処理工程を見直す。,3_1,2_1
3,"Phase 3-1: 対策実施（使用部門）",checklist_with_status,運転状況確認,バルブを完全に開ける。,3_2,2_2
3,"Phase 3-1: 対策実施（使用部門）",checklist_with_status,外観・目視点検,ストレーナーを分解し、内部を清掃する。,3_3,2_3
3,"Phase 3-1: 対策実施（使用部門）",checklist_with_status,外観・目視点検,ポンプ本体および配管のエア抜きを再度、確実に行う。,3_4,2_4
3,"Phase 3-1: 対策実施（使用部門）",checklist_with_status,外観・目視点検,冷却水の供給を復旧させ、流量を再調整する。,3_5,2_5
3,"Phase 3-1: 対策実施（使用部門）",checklist_with_status,計器類確認,計器類確認,3_6,2_6
3,"Phase 3-1: 対策実施（使用部門）",checklist_with_status,計器類確認,（過電流の場合）運転を停止し、メンテナンス部門へ調査を依頼する。,3_7,2_7
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,制御・電気系統,モーターへの供給電圧が不均一または低下している（欠相を含む）,4_0,
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,制御・電気系統,モーター巻線の絶縁抵抗が規定値以下,4_1,
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,制御・電気系統,過負荷保護装置（サーマルリレー）の設定値が不適切,4_2,
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,ポンプ本体・内部部品,前後ベアリング（スリーブベアリング）に異常な摩耗、傷、焼き付きがある,4_3,
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,ポンプ本体・内部部品,インペラ（羽根車）に摩耗、腐食、異物の詰まりがある,4_4,
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,ポンプ本体・内部部品,スラストワッシャー（スラスト軸受）に摩耗や傷がある,4_5,
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,ポンプ本体・内部部品,ロータキャンまたはステータキャンに変形、腐食、接触痕がある,4_6,
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,配管・システム,吸込配管の構造が原因で、空気だまりが発生している,4_7,
4,"Phase 2-2: 故障原因調査（メンテナンス部門）",checklist_with_status,配管・システム,キャビテーション（液体の沸騰）が発生する運転条件になっている,4_8,
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,制御・電気系統,電源系統を点検し、電圧が不安定な原因を特定・修理する。,5_0,4_0
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,制御・電気系統,絶縁不良の場合、モーターを交換する。,5_1,4_1
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,制御・電気系統,過負荷保護装置の設定値を再設定する。,5_2,4_2
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,ポンプ本体・内部部品,摩耗・損傷したベアリングを新品に交換する。,5_3,4_3
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,ポンプ本体・内部部品,摩耗・損傷したインペラを交換し、詰まりを除去する。,5_4,4_4
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,ポンプ本体・内部部品,摩耗したスラストワッシャーを新品に交換する。,5_5,4_5
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,ポンプ本体・内部部品,変形・損傷したキャンを持つモーターを交換する。,5_6,4_6
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,配管・システム,空気だまりが発生しないよう、配管経路の修正を検討・実施する。,5_7,4_7
5,"Phase 3-2: 対策実施（メンテナンス部門）",checklist_with_status,配管・システム,吸込配管径の見直しや、運転条件の変更を検討・実施する。,5_8,4_8
6,"Phase 4: 再起動前準備",checklist_with_status,復旧確認,交換した部品や修理箇所が、メーカーの仕様通りに正しく組付けられていることを確認する。,6_0,
6,"Phase 4: 再起動前準備",checklist_with_status,復旧確認,ポンプ内部および吸込配管が、完全に液体で満たされていること（プライミング）を確認する。,6_1,
6,"Phase 4: 再起動前準備",checklist_with_status,復旧確認,工具、部品、ウエスなどがポンプ本体や周辺に放置されていないことを確認する。,6_2,
6,"Phase 4: 再起動前準備",checklist_with_status,安全確認,各部のボルトやフランジが、規定トルクで締め付けられていることを確認する。,6_3,
6,"Phase 4: 再起動前準備",checklist_with_status,安全確認,関係者全員の安全を確認後、ロックアウト/タグアウトを正規の手順で解除する。,6_4,
6,"Phase 4: 再起動前準備",checklist_with_status,電源投入,制御盤の主電源を投入し、エラー表示などが出ていないことを確認する。,6_5,
6,"Phase 4: 再起動前準備",checklist_with_status,状態記録,故障内容、原因、対策、交換部品などを設備台帳や作業報告書に正確に記録する。,6_6,
7,"Phase 5: 試運転・正規運転",checklist_with_status,寸動運転,モーターを瞬間的に回転させ、回転方向が正しいこと、および引っ掛かりや接触音がないことを確認する。,7_0,
7,"Phase 5: 試運転・正規運転",checklist_with_status,無負荷運転,吐出側バルブを少し開けた状態で運転を開始し、再度エア抜きを行い、運転音が正常であることを確認する。,7_1,
7,"Phase 5: 試運転・正規運転",checklist_with_status,段階的な速度上昇,吐出側バルブを徐々に開き、正規の流量・圧力まで負荷をかけていく過程で、振動や騒音に異常がないことを確認する。,7_2,
7,"Phase 5: 試運転・正規運転",checklist_with_status,性能指標確認,正規の運転状態で、吐出圧力、流量、モーター電流値が規定値で安定していることを測定・確認する。,7_3,
7,"Phase 5: 試運転・正規運転",checklist_with_status,性能指標確認,ポンプ本体モーター部の表面温度に異常な上昇がないことを測定・確認する。,7_4,
7,"Phase 5: 試運転・正規運転",checklist_with_status,正規運転・監視,正規運転移行後、TRGモニタ（装備されている場合）の指示値が安定していることを確認する。,7_5,
7,"Phase 5: 試運転・正規運転",checklist_with_status,正規運転・監視,運転開始後の一定時間（例：30分間）は重点的に監視し、異常の再発がないことを確認する。,7_6,
`;

    let checklistData = [];
    let currentPhase = 1;
    let totalPhases = 0;
    let userSelections = {};
    const fileNameForStorage = "Canned_Pump_Checklist.html";

    const selectionKey = `userSelections_${fileNameForStorage}`;
    const phaseKey = `currentPhase_${fileNameForStorage}`;

    function initialize() {
        console.log("1. 初期化開始");
        try {
            Papa.parse(csvData, {
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    console.log("2. CSVデータ解析完了");
                    if (results.errors && results.errors.length > 0) {
                        console.error("CSV Parsing Errors:", results.errors);
                        $('#checklist-container').text("エラー: チェックリストのデータ形式に問題があります。");
                        return;
                    }
                    
                    checklistData = results.data;
                    if (!checklistData || checklistData.length === 0) {
                        console.error("エラー: checklistDataが空です。");
                        $('#checklist-container').text("エラー: チェックリストデータが空か、不正な形式です。");
                        return;
                    }

                    if (sessionStorage.getItem(selectionKey)) {
                        userSelections = JSON.parse(sessionStorage.getItem(selectionKey));
                    }
                    if (sessionStorage.getItem(phaseKey)) {
                        currentPhase = parseInt(sessionStorage.getItem(phaseKey));
                    }
                    console.log("3. sessionStorage読み込み完了");

                    totalPhases = Math.max(...checklistData.map(item => parseInt(item.phase)));
                    renderPhase(currentPhase);
                }
            });
        } catch (e) {
            console.error("初期化中にエラーが発生しました:", e);
            $('#checklist-container').text("エラー: アプリケーションの初期化に失敗しました。");
        }
    }

    function renderPhase(phase) {
        console.log(`4. Phase ${phase} のレンダリング開始`);
        let container = $('#checklist-container');
        container.empty();

        const phaseData = checklistData.filter(item => parseInt(item.phase) === phase);
        if (phaseData.length === 0) {
            console.log(`Phase ${phase} には項目がありません。`);
            if (phase <= totalPhases) {
                container.append('<p>このフェーズで表示する項目はありません。次へ進んでください。</p>');
            } else {
                container.append('<p>チェックリスト完了です。</p>');
            }
            updateNavigation();
            updateNextButtonState();
            return;
        }

        const phaseTitle = phaseData[0].phase_title;
        container.append(`<h2 class="phase-title">${phaseTitle}</h2>`);
        console.log(`5. Phaseタイトル '${phaseTitle}' を表示`);

        let itemsToShow = phaseData;
        if (phase === 3 || phase === 5) {
            const linkedPhaseNumber = phase === 3 ? 2 : 4;
            const problemItemIds = Object.values(userSelections)
                .filter(sel => sel.phase === linkedPhaseNumber && sel.value === '問題あり')
                .map(sel => sel.id);
            
            console.log(`Phase ${linkedPhaseNumber} からの問題項目ID:`, problemItemIds);
            itemsToShow = phaseData.filter(item => problemItemIds.includes(item.linked_item_id));

            if (itemsToShow.length === 0) {
                container.append('<p>前のフェーズで「問題あり」とされた項目はありません。次へ進んでください。</p>');
            }
        }

        if (itemsToShow.length > 0) {
            renderItems(itemsToShow, phase);
        }
        
        updateNavigation();
        updateNextButtonState();
    }
    
    function renderItems(items, phase) {
        const groupedByCategory = items.reduce((acc, item) => {
            (acc[item.category] = acc[item.category] || []).push(item);
            return acc;
        }, {});

        for (const category in groupedByCategory) {
            $('#checklist-container').append(`<h4 class="category-title">${category}</h4>`);
            const itemsInCategory = groupedByCategory[category];
            itemsInCategory.forEach(item => {
                const itemKey = item.item_id;
                const savedValue = userSelections[itemKey] ? userSelections[itemKey].value : undefined;
                let inputs = '';

                if (item.type === 'checklist') {
                    const isChecked = savedValue === 'checked';
                    inputs = `<input type="checkbox" class="form-check-input" data-item-key="${itemKey}" ${isChecked ? 'checked' : ''}>`;
                } else {
                    if (phase === 2 || phase === 4) {
                        const isOK = savedValue === '問題なし';
                        const isNG = savedValue === '問題あり';
                        inputs = `
                            <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                <label class="btn btn-outline-success ${isOK ? 'active' : ''}"><input type="radio" name="${itemKey}" value="問題なし" ${isOK ? 'checked' : ''}> 問題なし</label>
                                <label class="btn btn-outline-danger ${isNG ? 'active' : ''}"><input type="radio" name="${itemKey}" value="問題あり" ${isNG ? 'checked' : ''}> 問題あり</label>
                            </div>`;
                    } else {
                         const isDone = savedValue === '実施済み';
                         const isNA = savedValue === '非該当';
                         inputs = `
                             <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                 <label class="btn btn-outline-primary ${isDone ? 'active' : ''}"><input type="radio" name="${itemKey}" value="実施済み" ${isDone ? 'checked' : ''}> 実施済み</label>
                                 <label class="btn btn-outline-secondary ${isNA ? 'active' : ''}"><input type="radio" name="${itemKey}" value="非該当" ${isNA ? 'checked' : ''}> 非該当</label>
                             </div>`;
                    }
                }
                $('#checklist-container').append(`<div class="checklist-item-row"><label class="item-label">${item.item}</label><div>${inputs}</div></div>`);
            });
        }
        console.log("6. 全項目のレンダリング完了");
    }

    function updateNavigation() {
        $('#prev-btn').toggle(currentPhase > 1);
        $('#next-btn').toggle(currentPhase < totalPhases);
        $('#print-btn').toggle(currentPhase >= 3);
    }

    function updateNextButtonState() {
        let enabled = false;
        const phaseData = checklistData.filter(item => parseInt(item.phase) === currentPhase);

        if (phaseData.length === 0) {
            enabled = true; // Enable if there are no items in the phase
        } else if (currentPhase === 1) {
            const emergencyItems = phaseData.filter(i => i.category === '緊急停止措置');
            const detectionItems = phaseData.filter(i => i.category === '異常検知');
            
            const emergencyAllChecked = emergencyItems.every(item => userSelections[item.item_id] && userSelections[item.item_id].value === 'checked');
            const detectionOneChecked = detectionItems.some(item => userSelections[item.item_id] && userSelections[item.item_id].value === 'checked');
            
            enabled = emergencyAllChecked && detectionOneChecked;
        } else {
            let itemsToCheck = phaseData;
            if (currentPhase === 3 || currentPhase === 5) {
                const linkedPhaseNumber = currentPhase === 3 ? 2 : 4;
                const problemItemIds = Object.values(userSelections)
                    .filter(sel => sel.phase === linkedPhaseNumber && sel.value === '問題あり')
                    .map(sel => sel.id);
                itemsToCheck = itemsToCheck.filter(item => problemItemIds.includes(item.linked_item_id));
            }
            
            if (itemsToCheck.length === 0) {
                enabled = true;
            } else {
                enabled = itemsToCheck.every(item => userSelections[item.item_id]);
            }
        }
        $('#next-btn').prop('disabled', !enabled);
    }

    $('#checklist-container').on('change', 'input', function() {
        const key = $(this).attr('name') || $(this).data('item-key');
        const value = $(this).is(':checkbox') ? ($(this).is(':checked') ? 'checked' : 'unchecked') : $(this).val();
        
        userSelections[key] = { value: value, id: key, phase: currentPhase };
        sessionStorage.setItem(selectionKey, JSON.stringify(userSelections));
        updateNextButtonState();
    });

    $('#next-btn').click(function() {
        if (currentPhase < totalPhases) {
            currentPhase++;
            sessionStorage.setItem(phaseKey, currentPhase);
            renderPhase(currentPhase);
        }
    });

    $('#prev-btn').click(function() {
        if (currentPhase > 1) {
            currentPhase--;
            sessionStorage.setItem(phaseKey, currentPhase);
            renderPhase(currentPhase);
        }
    });

    $('#exit-btn').click(function() {
        if (confirm('メインメニューに戻りますか？\n(入力内容は保存されます)')) {
            window.location.href = 'index.html';
        }
    });

    $('#print-btn').click(function() {
        const checklistTitle = "「キャンドポンプ（業務用）」異常対応チェックリスト";

        let summaryHtml = `<div style="padding: 20px; font-family: sans-serif;"><h1>${checklistTitle} - 実施報告書</h1><p><strong>実施日:</strong> ${new Date().toLocaleDateString()}</p><hr>`;

        // Phase 1
        summaryHtml += '<h3>Phase 1: 異常検知・緊急停止の状況</h3>';
        const phase1_detection = checklistData.filter(item => parseInt(item.phase) === 1 && item.category === '異常検知');
        const phase1_stop = checklistData.filter(item => parseInt(item.phase) === 1 && item.category === '緊急停止措置');
        summaryHtml += '<h4>異常検知</h4><ul>';
        let detectionChecked = false;
        phase1_detection.forEach(item => {
            if (userSelections[item.item_id] && userSelections[item.item_id].value === 'checked') {
                summaryHtml += `<li>${item.item}</li>`;
                detectionChecked = true;
            }
        });
        if (!detectionChecked) summaryHtml += '<li>検知された異常はありません。</li>';
        summaryHtml += '</ul><h4>緊急停止措置</h4><ul>';
        phase1_stop.forEach(item => {
            const status = (userSelections[item.item_id] && userSelections[item.item_id].value === 'checked') ? '実施' : '未実施';
            summaryHtml += `<li>${item.item}: <strong>${status}</strong></li>`;
        });
        summaryHtml += '</ul><hr>';

        // Phase 2-1
        summaryHtml += '<h3>Phase 2-1: 故障原因調査（使用部門）</h3><ul>';
        const phase2Data = checklistData.filter(item => parseInt(item.phase) === 2);
        let causeInvestigated = false;
        phase2Data.forEach(item => {
            if (userSelections[item.item_id]) {
                summaryHtml += `<li>${item.item}: <strong>${userSelections[item.item_id].value}</strong></li>`;
                causeInvestigated = true;
            }
        });
        if (!causeInvestigated) summaryHtml += '<li>故障原因調査の項目はありません。</li>';
        summaryHtml += '</ul><hr>';

        // Phase 3-1 (Corrected Logic)
        summaryHtml += '<h3>Phase 3-1: 対策実施（使用部門）</h3><ul>';
        const problemItemIdsFromPhase2 = Object.values(userSelections)
            .filter(sel => sel.phase === 2 && sel.value === '問題あり')
            .map(sel => sel.id);
        const phase3ItemsToShow = checklistData.filter(item => 
            parseInt(item.phase) === 3 && problemItemIdsFromPhase2.includes(item.linked_item_id)
        );

        let measuresTaken = false;
        phase3ItemsToShow.forEach(item => {
            if (userSelections[item.item_id]) {
                summaryHtml += `<li>${item.item}: <strong>${userSelections[item.item_id].value}</strong></li>`;
                measuresTaken = true;
            }
        });

        if (!measuresTaken) {
            if (phase3ItemsToShow.length > 0) {
                 summaryHtml += '<li>選択された対策項目はありません。</li>';
            } else {
                 summaryHtml += '<li>前のフェーズで「問題あり」とされた項目がなかったため、対策項目はありません。</li>';
            }
        }
        summaryHtml += '</ul></div>';

        $('#printable-area').html(summaryHtml);
        window.print();
    });
    
    initialize();
});
    </script>
</body>
</html>